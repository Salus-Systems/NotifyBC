<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Developer Notes | NotifyBC</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" type="image/x-icon" href="/NotifyBC/version/2-pre-alpha/favicon.ico">
    <meta name="description" content="A versatile notification API server">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/NotifyBC/version/2-pre-alpha/assets/css/0.styles.34505621.css" as="style"><link rel="preload" href="/NotifyBC/version/2-pre-alpha/assets/js/app.7203e61b.js" as="script"><link rel="preload" href="/NotifyBC/version/2-pre-alpha/assets/js/4.ef7266ed.js" as="script"><link rel="preload" href="/NotifyBC/version/2-pre-alpha/assets/js/5.c02a3e01.js" as="script"><link rel="preload" href="/NotifyBC/version/2-pre-alpha/assets/js/42.a104efbd.js" as="script"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/1.bd48a1db.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/10.2bef35fd.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/11.4bbd994b.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/12.7f56b1ed.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/13.288679e1.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/14.bce72d75.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/15.60f03866.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/16.70116f69.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/17.e411f562.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/18.b41f3da7.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/19.321b833f.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/20.71b61f7e.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/21.c7ec8954.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/22.d13a62e2.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/23.95642fe5.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/24.055c9570.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/25.4595ff74.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/26.aa980f89.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/27.985b5b78.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/28.a665c3e9.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/29.c42d69bf.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/30.d1a04973.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/31.eeb26368.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/32.9b139893.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/33.ae9c94a6.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/34.3e34c15e.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/35.e934d5e7.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/36.e12e0214.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/37.09514c06.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/38.3f3a39f3.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/39.0e227568.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/40.9e427c7b.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/41.463d0cde.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/43.bee8ff6c.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/44.c9a728a0.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/45.ff07e7e1.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/6.46c3f8c1.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/7.fad6e7a1.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/8.80e335db.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/9.d6c0ab18.js"><link rel="prefetch" href="/NotifyBC/version/2-pre-alpha/assets/js/vendors~docsearch.7c8df9eb.js">
    <link rel="stylesheet" href="/NotifyBC/version/2-pre-alpha/assets/css/0.styles.34505621.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/NotifyBC/version/2-pre-alpha/" class="home-link router-link-active"><img src="/NotifyBC/version/2-pre-alpha/img/logo.svg" alt="NotifyBC" class="logo"></a> <!----> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/NotifyBC/version/2-pre-alpha/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-pre-alpha/docs/" class="nav-link router-link-active">
  Docs
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-pre-alpha/help/" class="nav-link">
  Help
</a></div> <a href="https://github.com/bcgov/NotifyBC" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/NotifyBC/version/2-pre-alpha/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-pre-alpha/docs/" class="nav-link router-link-active">
  Docs
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-pre-alpha/help/" class="nav-link">
  Help
</a></div> <a href="https://github.com/bcgov/NotifyBC" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-pre-alpha/docs/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/overview/" class="sidebar-link">Overview</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/quickstart/" class="sidebar-link">Quick Start</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/installation/" class="sidebar-link">Installation</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/usage/" class="sidebar-link">Basic Usage</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Configuration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-overview/" class="sidebar-link">Configuration Overview</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-adminIpList/" class="sidebar-link">Admin IP List</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-reverseProxyIpLists/" class="sidebar-link">Reverse Proxy IP Lists</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-httpHost/" class="sidebar-link">HTTP Host</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-smtp/" class="sidebar-link">SMTP</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-sms/" class="sidebar-link">SMS</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-subscription/" class="sidebar-link">Subscription</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-notification/" class="sidebar-link">Notification</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-database/" class="sidebar-link">Database</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-nodeRoles/" class="sidebar-link">Node Roles</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-cronJobs/" class="sidebar-link">Cron Jobs</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-rsaKeys/" class="sidebar-link">RSA Keys</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-internalHttpHost/" class="sidebar-link">Internal HTTP Host</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-inboundSmtpServer/" class="sidebar-link">Inbound SMTP Server</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-listUnsubscribeByEmail/" class="sidebar-link">List-unsubscribe by Email</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-notificationBounce/" class="sidebar-link">Notification Bounce</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/config-workerProcessCount/" class="sidebar-link">Worker Process Count</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-pre-alpha/docs/api-overview/" class="sidebar-link">API Overview</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/api-subscription/" class="sidebar-link">Subscription</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/api-notification/" class="sidebar-link">Notification</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/api-config/" class="sidebar-link">Configuration</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/api-administrator/" class="sidebar-link">Administrator</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/api-bounce/" class="sidebar-link">Bounce</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-pre-alpha/docs/benchmarks/" class="sidebar-link">Benchmarks</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/bulk-import/" class="sidebar-link">Bulk Import</a></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/developer-notes/" aria-current="page" class="active sidebar-link">Developer Notes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NotifyBC/version/2-pre-alpha/docs/developer-notes/#automated-testing" class="sidebar-link">Automated Testing</a></li><li class="sidebar-sub-header"><a href="/NotifyBC/version/2-pre-alpha/docs/developer-notes/#code-coverage" class="sidebar-link">Code Coverage</a></li></ul></li><li><a href="/NotifyBC/version/2-pre-alpha/docs/miscellaneous/migration.html" class="sidebar-link">Migration Guide</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Meta</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-pre-alpha/docs/conduct/" class="sidebar-link">Code of Conduct</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="developer-notes"><a href="#developer-notes" class="header-anchor">#</a> Developer Notes</h1> <h2 id="automated-testing"><a href="#automated-testing" class="header-anchor">#</a> Automated Testing</h2> <p>Test framework is created with and follows <a href="https://jasmine.github.io/2.6/node.html" target="_blank" rel="noopener noreferrer">Jasmine 2.6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> convention. To launch test, run <code>npm test</code>. To debug test scripts in IDE such as WebStorm, create a Node.js run/debug config, set <em>cwd</em> to project root and script to <em>/node_modules/jasmine/bin/jasmine.js</em>.</p> <p>Jenkins CI runs tests as part of the build, therefore all test scripts should be able to run unattended, headless, quickly and depend only on local resources.</p> <h3 id="writing-test-specs"><a href="#writing-test-specs" class="header-anchor">#</a> Writing Test Specs</h3> <p>Thanks to <a href="https://github.com/visionmedia/supertest" target="_blank" rel="noopener noreferrer">supertest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and LoopBack's <a href="https://loopback.io/doc/en/lb3/Memory-connector.html" target="_blank" rel="noopener noreferrer">memory database connector<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, test specs can be written to cover nearly end-to-end request processing workflow (only <em>sendMail</em> and <em>sendSMS</em> need to be mocked). This allows test specs to anchor onto business requirements rather than program units such as functions or files, resulting in regression tests that are more resilient to code refactoring.
Whenever possible, a test spec should be written to</p> <ul><li>start at a processing phase as early as possible. For example, to test a REST end point, start with the HTTP user request.</li> <li>assert outcome of a processing phase as late and down below as possible - the HTTP response body/code, the database record created, for example.</li> <li>avoid asserting middleware function input/output to facilitate code refactoring.</li> <li>mock email/sms sending function (implemented by default). Inspect the input of the function, or at least assert the function has been called.</li></ul> <h2 id="code-coverage"><a href="#code-coverage" class="header-anchor">#</a> Code Coverage</h2> <p>After running <code>npm test</code>, Istanbul code coverage report is generated in git ignored folder <em>/coverage</em>. <em>/coverage/lcov-report/index.html</em> is the report entry point.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/NotifyBC/version/2-pre-alpha/docs/bulk-import/" class="prev">
        Bulk Import
      </a></span> <span class="next"><a href="/NotifyBC/version/2-pre-alpha/docs/miscellaneous/migration.html">
        Migration Guide
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/NotifyBC/version/2-pre-alpha/assets/js/app.7203e61b.js" defer></script><script src="/NotifyBC/version/2-pre-alpha/assets/js/4.ef7266ed.js" defer></script><script src="/NotifyBC/version/2-pre-alpha/assets/js/5.c02a3e01.js" defer></script><script src="/NotifyBC/version/2-pre-alpha/assets/js/42.a104efbd.js" defer></script>
  </body>
</html>
