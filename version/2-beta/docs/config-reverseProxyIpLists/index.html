<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reverse Proxy IP Lists | NotifyBC</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" type="image/x-icon" href="/NotifyBC/version/2-beta/favicon.ico">
    <meta name="description" content="A versatile notification API server">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/NotifyBC/version/2-beta/assets/css/0.styles.15483989.css" as="style"><link rel="preload" href="/NotifyBC/version/2-beta/assets/js/app.256ee359.js" as="script"><link rel="preload" href="/NotifyBC/version/2-beta/assets/js/4.a700b1f7.js" as="script"><link rel="preload" href="/NotifyBC/version/2-beta/assets/js/5.cf402d1d.js" as="script"><link rel="preload" href="/NotifyBC/version/2-beta/assets/js/28.5b1425a5.js" as="script"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/1.bd48a1db.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/10.2d1de9f4.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/11.d35ddde0.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/12.f3c91a2f.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/13.05e9da27.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/14.b87c60c6.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/15.f73023f1.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/16.2ed3730c.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/17.cbd627ce.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/18.756222b5.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/19.557c0ea3.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/20.c77e784c.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/21.c1b24b7b.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/22.02672d0d.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/23.2adf3a76.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/24.d1d4d0ea.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/25.663fb402.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/26.734cc4b2.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/27.79b567ab.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/29.dd726e42.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/30.e7e1ef1b.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/31.7b157fc7.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/32.b95646e3.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/33.c6024fe0.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/34.d4b18238.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/35.a13560f7.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/36.65ca2a4b.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/37.33b9b3b2.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/38.7676a2e2.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/39.405c3a02.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/40.8478cb31.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/41.bae7d15a.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/42.95833598.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/43.0163e7ef.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/44.dd389b91.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/45.3d0d2b02.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/46.22848106.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/6.46c3f8c1.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/7.5d4b76e5.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/8.5c6afc23.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/9.d6c0ab18.js"><link rel="prefetch" href="/NotifyBC/version/2-beta/assets/js/vendors~docsearch.22099875.js">
    <link rel="stylesheet" href="/NotifyBC/version/2-beta/assets/css/0.styles.15483989.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/NotifyBC/version/2-beta/" class="home-link router-link-active"><img src="/NotifyBC/version/2-beta/img/logo.svg" alt="NotifyBC" class="logo"></a> <!----> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/NotifyBC/version/2-beta/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-beta/docs/" class="nav-link router-link-active">
  Docs
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-beta/help/" class="nav-link">
  Help
</a></div> <a href="https://github.com/bcgov/NotifyBC" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/NotifyBC/version/2-beta/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-beta/docs/" class="nav-link router-link-active">
  Docs
</a></div><div class="nav-item"><a href="/NotifyBC/version/2-beta/help/" class="nav-link">
  Help
</a></div> <a href="https://github.com/bcgov/NotifyBC" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-beta/docs/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/NotifyBC/version/2-beta/docs/overview/" class="sidebar-link">Overview</a></li><li><a href="/NotifyBC/version/2-beta/docs/quickstart/" class="sidebar-link">Quick Start</a></li><li><a href="/NotifyBC/version/2-beta/docs/installation/" class="sidebar-link">Installation</a></li><li><a href="/NotifyBC/version/2-beta/docs/usage/" class="sidebar-link">Basic Usage</a></li><li><a href="/NotifyBC/version/2-beta/docs/what's-new/" class="sidebar-link">What's New</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Configuration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-beta/docs/config-overview/" class="sidebar-link">Configuration Overview</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-adminIpList/" class="sidebar-link">Admin IP List</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-reverseProxyIpLists/" aria-current="page" class="active sidebar-link">Reverse Proxy IP Lists</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-httpHost/" class="sidebar-link">HTTP Host</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-smtp/" class="sidebar-link">SMTP</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-sms/" class="sidebar-link">SMS</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-subscription/" class="sidebar-link">Subscription</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-notification/" class="sidebar-link">Notification</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-database/" class="sidebar-link">Database</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-nodeRoles/" class="sidebar-link">Node Roles</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-cronJobs/" class="sidebar-link">Cron Jobs</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-rsaKeys/" class="sidebar-link">RSA Keys</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-internalHttpHost/" class="sidebar-link">Internal HTTP Host</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-inboundSmtpServer/" class="sidebar-link">Inbound SMTP Server</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-listUnsubscribeByEmail/" class="sidebar-link">List-unsubscribe by Email</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-notificationBounce/" class="sidebar-link">Notification Bounce</a></li><li><a href="/NotifyBC/version/2-beta/docs/config-workerProcessCount/" class="sidebar-link">Worker Process Count</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-beta/docs/api-overview/" class="sidebar-link">API Overview</a></li><li><a href="/NotifyBC/version/2-beta/docs/api-subscription/" class="sidebar-link">Subscription</a></li><li><a href="/NotifyBC/version/2-beta/docs/api-notification/" class="sidebar-link">Notification</a></li><li><a href="/NotifyBC/version/2-beta/docs/api-config/" class="sidebar-link">Configuration</a></li><li><a href="/NotifyBC/version/2-beta/docs/api-administrator/" class="sidebar-link">Administrator</a></li><li><a href="/NotifyBC/version/2-beta/docs/api-bounce/" class="sidebar-link">Bounce</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-beta/docs/benchmarks/" class="sidebar-link">Benchmarks</a></li><li><a href="/NotifyBC/version/2-beta/docs/bulk-import/" class="sidebar-link">Bulk Import</a></li><li><a href="/NotifyBC/version/2-beta/docs/developer-notes/" class="sidebar-link">Developer Notes</a></li><li><a href="/NotifyBC/version/2-beta/docs/migration/" class="sidebar-link">Migration Guide</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Meta</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NotifyBC/version/2-beta/docs/conduct/" class="sidebar-link">Code of Conduct</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="reverse-proxy-ip-lists"><a href="#reverse-proxy-ip-lists" class="header-anchor">#</a> Reverse Proxy IP Lists</h1> <p>SiteMinder, being a gateway approached SSO solution, expects the backend HTTP access point of the web sites it protests to be firewall restricted, otherwise the SiteMinder injected HTTP headers can be easily spoofed. However, the restriction cannot be easily implemented on PAAS such as OpenShift. To mitigate, two configuration objects are introduced to create an application-level firewall, both are arrays of ip addresses in the format of <a href="https://en.wikipedia.org/wiki/Dot-decimal_notation" target="_blank" rel="noopener noreferrer">dot-decimal<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation" target="_blank" rel="noopener noreferrer">CIDR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> notation</p> <ul><li><em>siteMinderReverseProxyIps</em> contains a list of ips or ranges of SiteMinder Web Agents. If set, then the SiteMinder HTTP headers are trusted only if the request is routed from the listed nodes.</li> <li><em>trustedReverseProxyIps</em> contains a list of ips or ranges of trusted reverse proxies between the SiteMinder Web Agents and <em>NotifyBC</em> application. When running on OpenShift, this is usually the OpenShift router. Express.js <a href="https://expressjs.com/en/guide/behind-proxies.html" target="_blank" rel="noopener noreferrer">trust proxy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is set to this config object.</li></ul> <p>By default <em>trustedReverseProxyIps</em> is empty and <em>siteMinderReverseProxyIps</em> contains only localhost as defined by <em>defaultSiteMinderReverseProxyIps</em> in <em>/server/config.json</em></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;defaultSiteMinderReverseProxyIps&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To modify, add following objects to file /server/config.local.js</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  siteMinderReverseProxyIps<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'130.32.12.0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  trustedReverseProxyIps<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'172.17.0.0/16'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The rule to determine if the incoming request is authenticated by SiteMinder is</p> <ol><li>obtain the real client ip address by filtering out trusted proxy ips according to <a href="https://expressjs.com/en/guide/behind-proxies.html" target="_blank" rel="noopener noreferrer">Express behind proxies<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>if the real client ip is contained in <em>siteMinderReverseProxyIps</em>, then the request is from SiteMinder, and its SiteMinder headers are trusted; otherwise, the request is considered as directly from internet, and its SiteMinder headers are ignored.</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/NotifyBC/version/2-beta/docs/config-adminIpList/" class="prev">
        Admin IP List
      </a></span> <span class="next"><a href="/NotifyBC/version/2-beta/docs/config-httpHost/">
        HTTP Host
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/NotifyBC/version/2-beta/assets/js/app.256ee359.js" defer></script><script src="/NotifyBC/version/2-beta/assets/js/4.a700b1f7.js" defer></script><script src="/NotifyBC/version/2-beta/assets/js/5.cf402d1d.js" defer></script><script src="/NotifyBC/version/2-beta/assets/js/28.5b1425a5.js" defer></script>
  </body>
</html>
